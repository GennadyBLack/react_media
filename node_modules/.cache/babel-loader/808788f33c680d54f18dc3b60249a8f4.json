{"ast":null,"code":"import _slicedToArray from \"/home/gena/app/react_media/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/gena/app/react_media/src/node_modules/pages/authentication/index.js\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { Link, Redirect } from 'react-router-dom';\nimport useFetch from 'hooks/useFetch';\nimport useLocalStorage from 'hooks/useLocalStorage';\nimport { CurrentUserContext } from 'contexts/currentUser';\nimport BackendErrorMessages from 'components/backendErrorMessages';\n\nconst Authentication = props => {\n  const isLogin = props.match.path === '/login';\n  const pageTitle = isLogin ? 'Sign In' : 'Sign Up';\n  const descriptionLink = isLogin ? '/register' : '/login';\n  const descriptionText = isLogin ? 'Need an account?' : 'Have an account?';\n  const apiUrl = isLogin ? '/users/login' : '/users';\n\n  const _useState = useState(''),\n        _useState2 = _slicedToArray(_useState, 2),\n        email = _useState2[0],\n        setEmail = _useState2[1];\n\n  const _useState3 = useState(''),\n        _useState4 = _slicedToArray(_useState3, 2),\n        password = _useState4[0],\n        setPassword = _useState4[1];\n\n  const _useState5 = useState(''),\n        _useState6 = _slicedToArray(_useState5, 2),\n        username = _useState6[0],\n        setUsername = _useState6[1];\n\n  const _useState7 = useState(false),\n        _useState8 = _slicedToArray(_useState7, 2),\n        isSuccessfullSubmit = _useState8[0],\n        setIsSuccessfullSubmit = _useState8[1];\n\n  const _useFetch = useFetch(apiUrl),\n        _useFetch2 = _slicedToArray(_useFetch, 2),\n        _useFetch2$ = _useFetch2[0],\n        isLoading = _useFetch2$.isLoading,\n        response = _useFetch2$.response,\n        error = _useFetch2$.error,\n        doFetch = _useFetch2[1];\n\n  const _useLocalStorage = useLocalStorage('token'),\n        _useLocalStorage2 = _slicedToArray(_useLocalStorage, 2),\n        setToken = _useLocalStorage2[1];\n\n  const _useContext = useContext(CurrentUserContext),\n        _useContext2 = _slicedToArray(_useContext, 2),\n        dispatch = _useContext2[1];\n\n  const handleSubmit = event => {\n    event.preventDefault();\n    const user = isLogin ? {\n      email,\n      password\n    } : {\n      email,\n      password,\n      username\n    };\n    doFetch({\n      method: 'post',\n      data: {\n        user\n      }\n    });\n    console.log('values', email, password);\n  };\n\n  useEffect(() => {\n    if (!response) {\n      return;\n    }\n\n    console.log('response', response);\n    setToken(response.user.token);\n    setIsSuccessfullSubmit(true);\n    dispatch({\n      type: 'SET_AUTHORIZED',\n      payload: response.user\n    });\n  }, [response, setToken, dispatch]);\n\n  if (isSuccessfullSubmit) {\n    return React.createElement(Redirect, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    });\n  }\n\n  return React.createElement(\"div\", {\n    className: \"auth-page\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container page\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-md-6 offset-md-3 col-xs-12\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    className: \"text-xs-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, pageTitle), React.createElement(\"p\", {\n    className: \"text-xs-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, React.createElement(Link, {\n    to: descriptionLink,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, descriptionText)), error && React.createElement(BackendErrorMessages, {\n    backendErrors: error.errors,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }), React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, React.createElement(\"fieldset\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, !isLogin && React.createElement(\"fieldset\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control form-control-lg\",\n    placeholder: \"Username\",\n    value: username,\n    onChange: e => setUsername(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  })), React.createElement(\"fieldset\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"email\",\n    className: \"form-control form-control-lg\",\n    placeholder: \"Email\",\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  })), React.createElement(\"fieldset\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"password\",\n    className: \"form-control form-control-lg\",\n    placeholder: \"Password\",\n    value: password,\n    onChange: e => setPassword(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  })), React.createElement(\"button\", {\n    disabled: isLoading,\n    className: \"btn btn-lg btn-primary pull-xs-right\",\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, pageTitle)))))));\n};\n\nexport default Authentication;","map":{"version":3,"sources":["/home/gena/app/react_media/src/node_modules/pages/authentication/index.js"],"names":["React","useState","useEffect","useContext","Link","Redirect","useFetch","useLocalStorage","CurrentUserContext","BackendErrorMessages","Authentication","props","isLogin","match","path","pageTitle","descriptionLink","descriptionText","apiUrl","email","setEmail","password","setPassword","username","setUsername","isSuccessfullSubmit","setIsSuccessfullSubmit","isLoading","response","error","doFetch","setToken","dispatch","handleSubmit","event","preventDefault","user","method","data","console","log","token","type","payload","errors","e","target","value"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useContext} from 'react'\nimport {Link, Redirect} from 'react-router-dom'\n\nimport useFetch from 'hooks/useFetch'\nimport useLocalStorage from 'hooks/useLocalStorage'\nimport {CurrentUserContext} from 'contexts/currentUser'\nimport BackendErrorMessages from 'components/backendErrorMessages'\n\nconst Authentication = props => {\n  const isLogin = props.match.path === '/login'\n  const pageTitle = isLogin ? 'Sign In' : 'Sign Up'\n  const descriptionLink = isLogin ? '/register' : '/login'\n  const descriptionText = isLogin ? 'Need an account?' : 'Have an account?'\n  const apiUrl = isLogin ? '/users/login' : '/users'\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [username, setUsername] = useState('')\n  const [isSuccessfullSubmit, setIsSuccessfullSubmit] = useState(false)\n  const [{isLoading, response, error}, doFetch] = useFetch(apiUrl)\n  const [, setToken] = useLocalStorage('token')\n  const [, dispatch] = useContext(CurrentUserContext)\n\n  const handleSubmit = event => {\n    event.preventDefault()\n\n    const user = isLogin ? {email, password} : {email, password, username}\n\n    doFetch({\n      method: 'post',\n      data: {\n        user\n      }\n    })\n    console.log('values', email, password)\n  }\n\n  useEffect(() => {\n    if (!response) {\n      return\n    }\n    console.log('response', response)\n    setToken(response.user.token)\n    setIsSuccessfullSubmit(true)\n    dispatch({type: 'SET_AUTHORIZED', payload: response.user})\n  }, [response, setToken, dispatch])\n\n  if (isSuccessfullSubmit) {\n    return <Redirect to=\"/\" />\n  }\n\n  return (\n    <div className=\"auth-page\">\n      <div className=\"container page\">\n        <div className=\"row\">\n          <div className=\"col-md-6 offset-md-3 col-xs-12\">\n            <h1 className=\"text-xs-center\">{pageTitle}</h1>\n            <p className=\"text-xs-center\">\n              <Link to={descriptionLink}>{descriptionText}</Link>\n            </p>\n            {error && <BackendErrorMessages backendErrors={error.errors} />}\n            <form onSubmit={handleSubmit}>\n              <fieldset>\n                {!isLogin && (\n                  <fieldset className=\"form-group\">\n                    <input\n                      type=\"text\"\n                      className=\"form-control form-control-lg\"\n                      placeholder=\"Username\"\n                      value={username}\n                      onChange={e => setUsername(e.target.value)}\n                    />\n                  </fieldset>\n                )}\n                <fieldset className=\"form-group\">\n                  <input\n                    type=\"email\"\n                    className=\"form-control form-control-lg\"\n                    placeholder=\"Email\"\n                    value={email}\n                    onChange={e => setEmail(e.target.value)}\n                  />\n                </fieldset>\n                <fieldset className=\"form-group\">\n                  <input\n                    type=\"password\"\n                    className=\"form-control form-control-lg\"\n                    placeholder=\"Password\"\n                    value={password}\n                    onChange={e => setPassword(e.target.value)}\n                  />\n                </fieldset>\n                <button\n                  disabled={isLoading}\n                  className=\"btn btn-lg btn-primary pull-xs-right\"\n                  type=\"submit\"\n                >\n                  {pageTitle}\n                </button>\n              </fieldset>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Authentication\n"]},"metadata":{},"sourceType":"module"}