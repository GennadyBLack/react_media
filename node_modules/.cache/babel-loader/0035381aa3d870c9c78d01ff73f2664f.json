{"ast":null,"code":"import _slicedToArray from \"/home/gena/app/react_media/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport { useEffect, useContext } from 'react';\nimport useFetch from 'hooks/useFetch';\nimport { CurrentUserContext } from 'contexts/currentUser';\nimport useLocalStorage from 'hooks/useLocalStorage';\n\nconst CurrentUserChecker = ({\n  children\n}) => {\n  const _useContext = useContext(CurrentUserContext),\n        _useContext2 = _slicedToArray(_useContext, 2),\n        dispatch = _useContext2[1];\n\n  const _useFetch = useFetch('/user'),\n        _useFetch2 = _slicedToArray(_useFetch, 2),\n        response = _useFetch2[0].response,\n        doFetch = _useFetch2[1];\n\n  const _useLocalStorage = useLocalStorage('token'),\n        _useLocalStorage2 = _slicedToArray(_useLocalStorage, 1),\n        token = _useLocalStorage2[0];\n\n  useEffect(() => {\n    if (!token) {\n      dispatch({\n        type: 'SET_UNAUTHORIZED'\n      });\n      return;\n    }\n\n    doFetch();\n    dispatch({\n      type: 'LOADING'\n    });\n  }, [doFetch, dispatch, token]);\n  useEffect(() => {\n    if (!response) {\n      return;\n    }\n\n    dispatch({\n      type: 'SET_AUTHORIZED',\n      payload: response.user\n    });\n  }, [response, dispatch]);\n  return children;\n};\n\nexport default CurrentUserChecker;","map":{"version":3,"sources":["/home/gena/app/react_media/src/node_modules/components/currentUserChecker.js"],"names":["useEffect","useContext","useFetch","CurrentUserContext","useLocalStorage","CurrentUserChecker","children","dispatch","response","doFetch","token","type","payload","user"],"mappings":";AAAA,SAAQA,SAAR,EAAmBC,UAAnB,QAAoC,OAApC;AAEA,OAAOC,QAAP,MAAqB,gBAArB;AACA,SAAQC,kBAAR,QAAiC,sBAAjC;AACA,OAAOC,eAAP,MAA4B,uBAA5B;;AAEA,MAAMC,kBAAkB,GAAG,CAAC;AAACC,EAAAA;AAAD,CAAD,KAAgB;AAAA,sBACpBL,UAAU,CAACE,kBAAD,CADU;AAAA;AAAA,QAChCI,QADgC;;AAAA,oBAEXL,QAAQ,CAAC,OAAD,CAFG;AAAA;AAAA,QAEjCM,QAFiC,iBAEjCA,QAFiC;AAAA,QAEtBC,OAFsB;;AAAA,2BAGzBL,eAAe,CAAC,OAAD,CAHU;AAAA;AAAA,QAGlCM,KAHkC;;AAKzCV,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACU,KAAL,EAAY;AACVH,MAAAA,QAAQ,CAAC;AAACI,QAAAA,IAAI,EAAE;AAAP,OAAD,CAAR;AACA;AACD;;AAEDF,IAAAA,OAAO;AACPF,IAAAA,QAAQ,CAAC;AAACI,MAAAA,IAAI,EAAE;AAAP,KAAD,CAAR;AACD,GARQ,EAQN,CAACF,OAAD,EAAUF,QAAV,EAAoBG,KAApB,CARM,CAAT;AAUAV,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACQ,QAAL,EAAe;AACb;AACD;;AAEDD,IAAAA,QAAQ,CAAC;AAACI,MAAAA,IAAI,EAAE,gBAAP;AAAyBC,MAAAA,OAAO,EAAEJ,QAAQ,CAACK;AAA3C,KAAD,CAAR;AACD,GANQ,EAMN,CAACL,QAAD,EAAWD,QAAX,CANM,CAAT;AAOA,SAAOD,QAAP;AACD,CAvBD;;AAyBA,eAAeD,kBAAf","sourcesContent":["import {useEffect, useContext} from 'react'\n\nimport useFetch from 'hooks/useFetch'\nimport {CurrentUserContext} from 'contexts/currentUser'\nimport useLocalStorage from 'hooks/useLocalStorage'\n\nconst CurrentUserChecker = ({children}) => {\n  const [, dispatch] = useContext(CurrentUserContext)\n  const [{response}, doFetch] = useFetch('/user')\n  const [token] = useLocalStorage('token')\n\n  useEffect(() => {\n    if (!token) {\n      dispatch({type: 'SET_UNAUTHORIZED'})\n      return\n    }\n\n    doFetch()\n    dispatch({type: 'LOADING'})\n  }, [doFetch, dispatch, token])\n\n  useEffect(() => {\n    if (!response) {\n      return\n    }\n\n    dispatch({type: 'SET_AUTHORIZED', payload: response.user})\n  }, [response, dispatch])\n  return children\n}\n\nexport default CurrentUserChecker\n"]},"metadata":{},"sourceType":"module"}